<!DOCTYPE html>
<html>
<head>
    <title>全ファイル対応アップロード解析サイト</title>
</head>
<body>
<h2>ファイルをアップロードして解析・展開</h2>
<input type="file" id="fileinput" multiple>
<button onclick="upload()">アップロード</button>
<pre id="result"></pre>

<script>
async function upload() {
    const files = document.getElementById('fileinput').files;
    console.log("選択ファイル:", files);

    if (files.length === 0) {
        alert("ファイルを選択してください");
        return;
    }

    const form = new FormData();
    for (let f of files) form.append("files", f);

    try {
        const res = await fetch("/upload", { method: "POST", body: form });
        console.log("レスポンスステータス:", res.status);
        const data = await res.json();
        console.log("サーバー返却:", data);
        document.getElementById("result").innerText = JSON.stringify(data, null, 2);
    } catch (e) {
        console.error("アップロードエラー:", e);
        document.getElementById("result").innerText = "アップロードエラー: " + e;
    }
}
</script>
</body>
</html>
